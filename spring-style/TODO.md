* finish security for methods

* refactor code with scala philosophy