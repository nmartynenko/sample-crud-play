* cover with integration tests

* implement advanced validation